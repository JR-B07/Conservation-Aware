{% extends "base.html" %} {% block title %}Tabla QFD{% endblock %} {% block
content %}
<div class="container mt-4">
  <!-- Formulario para agregar Ques y Comos -->
  <form
    action="{{ url_for('generar_tabla') }}"
    method="POST"
    id="formulario-tabla"
  >
    <label for="ques">Agregar Ques (separados por comas):</label>
    <input type="text" name="ques" id="ques" required />
    <br />
    <label for="comos">Agregar Comos (separados por comas):</label>
    <input type="text" name="comos" id="comos" required />
    <br />
    <button type="submit" id="generar-tabla" class="btn btn-primary mt-2">
      Generar Tabla
    </button>
  </form>
  <!-- Tabla dinámica -->
  <div id="tabla-contenedor" class="mt-4">
    {% if qfd_data %}
    <table class="table table-bordered">
      <thead>
        <tr>
          <th class="align-middle">QUES</th>
          {% for col in qfd_data[0].keys() if col != "Ques" %}
          <th class="text-center">{{ col }}</th>
          {% endfor %}
          <th class="text-center">Total</th>
          <th class="text-center">Valor</th>
        </tr>
      </thead>
      <tbody>
        {% for row in qfd_data %}
        <tr>
          <td class="bg-light">{{ row['Ques'] }}</td>
          {% for col, value in row.items() if col != "Ques" %}
          <td contenteditable="true" class="text-center valor-celda">
            {{ value }}
          </td>
          {% endfor %}
          <td contenteditable="true" class="text-center valor-celda">
            {{ row['Total'] }}
          </td>
          <td contenteditable="true" class="text-center valor-celda">
            {{ row['Valor'] }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>
      No hay datos generados aún. Llena el formulario y presiona "Generar
      Tabla".
    </p>
    {% endif %}
  </div>
  <!-- Botón para guardar y descargar -->
  <div class="mt-3">
    <a
      href="{{ url_for('descargar_excel') }}"
      class="btn btn-success"
      role="button"
    >
      Guardar y Descargar
    </a>
  </div>
  <script>
    // Función para actualizar la tabla con datos dinámicos
    function actualizarTabla(qfdData) {
      // Same as before
    }
  </script>
  <style>
    /* Same as before */
  </style>
</div>
{% endblock %}
